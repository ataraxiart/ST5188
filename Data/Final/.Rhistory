list.files("./Code/Preprocessing")
getwd()
list.files(".")
list.files("")
list.files()
list.files("..")
list.files("...")
list.files("../")
list.files("./")
list.files(".../")
list.files("../..")
list.files("../../Code/Preprocessing")
# source libraries and functions under `Code` files
scripts = paste0("./Code/Preprocessing/", list.files("../../Code/Preprocessing"))
lapply(scripts, source)
scripts
# source libraries and functions under `Code` files
scripts = paste0("../../Code/Preprocessing/", list.files("../../Code/Preprocessing"))
lapply(scripts, source)
list.files(".")
list.files("../..")
list.files("../")
st_read("../../Data/Misc/Subzone/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T)
st_read("../../Data/Misc/Subzone/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T)
list.files("")
list.files(".")
list.files("..")
list.files("../")
list.files("../.")
list.files("../..")
list.files("/..")
list.files("/.")
list.files("/../.")
list.files("/../..")
list.files("../..")
any(df_boundary$LST == NA)
# retrieve all tif files
ls_img <- list.files("../../Data/Landsat/GEE_landsat8", pattern = "\\.tif$", full.names = TRUE)
ls_img
# retrieve all tif files
ls_img <- list.files("../../Data/Landsat/GEE_landsat8")
ls_img
# retrieve all tif files
ls_img <- list.files("../../Data/Landsat/GEE_landsat8", pattern = "\\.tif$", full.names = TRUE)
ls_img
nrow(ls_img)
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
scripts
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
scripts
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
# retrieve all tif files
ls_img <- list.files("../../Data/Landsat/GEE_landsat8", pattern = "\\.tif$", full.names = TRUE)
ls_img
ls_img
rast("../../Data/Landsat/GEE_landsat8/LST_Singapore_2024-11-16.tif")
rast("LST_Singapore_2024-11-16.tif")
basename("../../Data/Landsat/GEE_landsat8/LST_Singapore_2024-11-16.tif")
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| message: FALSE
#| echo: FALSE
setwd("/Users/amiraazad/Desktop/ST5188")
rm(list = ls())
library(dplyr)
library(sf)
library(terra)
library(ggplot2)
library(stringr)
boundary <- st_read("files/masterplan/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T) |>
select(PLN_AREA_N, geometry)
changi <- boundary |>
# filter(grepl("CHANGI", PLN_AREA_N)) |>
filter(PLN_AREA_N == "CHANGI") |>
st_union() |>
st_transform("EPSG:4326") |>
st_sf()
# import image
img <- "files/LST_Singapore_2013-05-26.tif"
date <- as.Date(str_extract(img, "\\d{4}-\\d{2}-\\d{2}"))
r <- rast(img) |>
project("EPSG:4326")
# save the min. temp
min_temp <- global(terra::mask(r, vect(changi)), fun = "min", na.rm = TRUE)[1,1]
r[is.na(r)] <- 0
#| fig.height: 5
#| fig.width: 5
#| fig.align: "center"
temp_changi <- terra::mask(r, vect(changi))
ext <- ext(changi)
temp_changi <- terra::crop(temp_changi, ext)
plot(temp_changi)
plot(st_boundary(changi), col = "black", add = TRUE)
# import boundary of region
# 2014 URA subzone
boundary <- st_read("files/masterplan/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T) |>
select(PLN_AREA_N, geometry)
changi <- boundary |>
# filter(grepl("CHANGI", PLN_AREA_N)) |>
filter(PLN_AREA_N == "CHANGI") |>
st_union() |>
st_transform("EPSG:4326") |>
st_sf()
# import image
img <- "files/LST_Singapore_2013-05-26.tif"
date <- as.Date(str_extract(img, "\\d{4}-\\d{2}-\\d{2}"))
r <- rast(img) |>
project("EPSG:4326")
# save the min. temp
min_temp <- global(terra::mask(r, vect(changi)), fun = "min", na.rm = TRUE)[1,1]
r[is.na(r)] <- 0
r
#| fig.width: 10
#| fig.align: "center"
plot(r)
plot(changi, add = TRUE,  col = rgb(0, 0, 1, alpha = 0.4))
# import boundary of region
# 2014 URA subzone
boundary <- st_read("files/masterplan/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T) |>
select(PLN_AREA_N, geometry)
changi <- boundary |>
# filter(grepl("CHANGI", PLN_AREA_N)) |>
filter(PLN_AREA_N == "CHANGI") |>
st_union() |>
st_transform("EPSG:4326") |>
st_sf()
# import image
img <- "files/LST_Singapore_2013-05-26.tif"
date <- as.Date(str_extract(img, "\\d{4}-\\d{2}-\\d{2}"))
r <- rast(img) |>
project("EPSG:4326")
# save the min. temp
min_temp <- global(terra::mask(r, vect(changi)), fun = "min", na.rm = TRUE)[1,1]
r[is.na(r)] <- 0
#| message: FALSE
#| echo: FALSE
setwd("/Users/amiraazad/Desktop/ST5188")
rm(list = ls())
library(dplyr)
library(sf)
library(terra)
library(ggplot2)
library(stringr)
# import boundary of region
# 2014 URA subzone
boundary <- st_read("files/masterplan/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T) |>
select(PLN_AREA_N, geometry)
changi <- boundary |>
# filter(grepl("CHANGI", PLN_AREA_N)) |>
filter(PLN_AREA_N == "CHANGI") |>
st_union() |>
st_transform("EPSG:4326") |>
st_sf()
# import image
img <- "files/LST_Singapore_2013-05-26.tif"
date <- as.Date(str_extract(img, "\\d{4}-\\d{2}-\\d{2}"))
rast(img)
r <- rast(img) |>
project("EPSG:4326")
plot(r)
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
warning(paste0("Skipping ", img, " — not enough points for kriging."))
warning(paste0("Skipping — not enough points for kriging."))
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| message: FALSE
#| echo: FALSE
setwd("/Users/amiraazad/Desktop/ST5188")
rm(list = ls())
library(dplyr)
library(sf)
library(terra)
library(ggplot2)
library(stringr)
# import boundary of region
# 2014 URA subzone
boundary <- st_read("files/masterplan/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T) |>
select(PLN_AREA_N, geometry)
changi <- boundary |>
# filter(grepl("CHANGI", PLN_AREA_N)) |>
filter(PLN_AREA_N == "CHANGI") |>
st_union() |>
st_transform("EPSG:4326") |>
st_sf()
# import image
img <- "files/LST_Singapore_2024-09-13.tif"
date <- as.Date(str_extract(img, "\\d{4}-\\d{2}-\\d{2}"))
r <- rast(img) |>
project("EPSG:4326")
# save the min. temp
min_temp <- global(terra::mask(r, vect(changi)), fun = "min", na.rm = TRUE)[1,1]
r[is.na(r)] <- 0
#| fig.width: 10
#| fig.align: "center"
plot(r)
plot(changi, add = TRUE,  col = rgb(0, 0, 1, alpha = 0.4))
#| fig.height: 5
#| fig.width: 5
#| fig.align: "center"
temp_changi <- terra::mask(r, vect(changi))
ext <- ext(changi)
temp_changi <- terra::crop(temp_changi, ext)
plot(temp_changi)
plot(st_boundary(changi), col = "black", add = TRUE)
temp_changi_agg <- temp_changi |>
aggregate(fact = 3, fun = "mean", na.rm = T)
temp_changi_agg <- ifel(temp_changi_agg$LST < min_temp, 0, temp_changi_agg$LST)
temp_changi_agg
plot(temp_changi_agg)
plot(st_boundary(changi), col = "black", add = TRUE)
df_changi <- terra::as.data.frame(temp_changi_agg, xy = TRUE, na.rm = TRUE) |>
mutate(LST = ifelse(LST == 0, NA, LST),
date = date)
summary(df_changi)
nrow(df_changi)
write.csv(df_changi, "LST_Singapore_2024-09-13.csv", row.names = FALSE)
nrow(df_changi)
5290/2
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
# aggregate temporally and obtain final data - naomi
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
# aggregate temporally and obtain final data - naomi
ls_img
# retrieve all tif files
ls_img <- list.files("../../Data/Landsat/GEE_landsat8", pattern = "\\.tif$", full.names = TRUE)
length(list.files("../../Data/Landsat/GEE_landsat8", pattern = "\\.tif$", full.names = TRUE))
print(paste0("Total skipped files: ", length(skipped_files)))
print(paste0("Total TIF files: ", length(ls_img)))
print(paste0("Successfully saved: ", length(rds_img)))
print(paste0("Total TIF files: ", length(ls_img)))
print(paste0("Successfully saved: ", length(rds_img)))
print(paste0("Total TIF files: ", length(ls_img)))
print(paste0("Successfully saved: ", length(rds_img)))
print(paste0("Total TIF files: ", length(ls_img)))
print(paste0("Successfully saved: ", length(rds_img)))
print(length(list.files(/Users/amiraazad/Documents/GitHub/ST5188/Data/Misc/SavedRDS)))
print(length(list.files("/Users/amiraazad/Documents/GitHub/ST5188/Data/Misc/SavedRDS")))
duplicated(skipped_files)
print(length(unique(ls_img)))  # Ensure this is 229
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| echo: FALSE
#| include: FALSE
# clear working directory
rm(list = ls())
# source libraries and functions under `Code` files
scripts = list.files("../../Code/Preprocessing", full.names = TRUE)
lapply(scripts, source)
#| echo: FALSE
#| include: FALSE
# this section is to pre-process CHANGI data
# extract, impute and combine data from images - swa + mira
df_changi <- combine_img(subzone = "CHANGI")
#| message: FALSE
#| echo: FALSE
setwd("/Users/amiraazad/Desktop/ST5188")
rm(list = ls())
library(dplyr)
library(sf)
library(terra)
library(ggplot2)
library(stringr)
# import boundary of region
# 2014 URA subzone
boundary <- st_read("files/masterplan/MP14_SUBZONE_NO_SEA_PL.shp", quiet = T) |>
select(PLN_AREA_N, geometry)
changi <- boundary |>
# filter(grepl("CHANGI", PLN_AREA_N)) |>
filter(PLN_AREA_N == "CHANGI") |>
st_union() |>
st_transform("EPSG:4326") |>
st_sf()
# import image
img <- "files/LST_Singapore_2018-03-21.tif"
date <- as.Date(str_extract(img, "\\d{4}-\\d{2}-\\d{2}"))
r <- rast(img) |>
project("EPSG:4326")
# save the min. temp
min_temp <- global(terra::mask(r, vect(changi)), fun = "min", na.rm = TRUE)[1,1]
r[is.na(r)] <- 0
#| fig.width: 10
#| fig.align: "center"
plot(r)
plot(changi, add = TRUE,  col = rgb(0, 0, 1, alpha = 0.4))
#| fig.height: 5
#| fig.width: 5
#| fig.align: "center"
temp_changi <- terra::mask(r, vect(changi))
ext <- ext(changi)
temp_changi <- terra::crop(temp_changi, ext)
plot(temp_changi)
plot(st_boundary(changi), col = "black", add = TRUE)
temp_changi_agg <- temp_changi |>
aggregate(fact = 3, fun = "mean", na.rm = T)
temp_changi_agg <- ifel(temp_changi_agg$LST < min_temp, 0, temp_changi_agg$LST)
temp_changi_agg
plot(temp_changi_agg)
plot(st_boundary(changi), col = "black", add = TRUE)
df_changi <- terra::as.data.frame(temp_changi_agg, xy = TRUE, na.rm = TRUE) |>
mutate(LST = ifelse(LST == 0, NA, LST),
date = date)
summary(df_changi)
nrow(df_changi)
write.csv(df_changi, "LST_Singapore_2024-09-13.csv", row.names = FALSE)
5289/5290
